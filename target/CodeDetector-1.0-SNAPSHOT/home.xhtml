<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">
    <h:head>
        <title>Docky 1.0.0</title>
        <link rel="icon" href="http://icons.iconarchive.com/icons/dtafalonso/yosemite-flat/512/Folder-icon.png" />
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        
        <h:outputStylesheet library="foundation-5/css" name="foundation.css" />
        <h:outputStylesheet library="foundation-5/css" name="normalize.css" />
        
        <h:outputScript library="foundation-5/js/vendor" name="jquery.js" />
        
        <h:outputScript library="foundation-5/js/vendor" name="modernizr.js" />
        <h:outputScript library="foundation-5/js" name="foundation.min.js" />
        <h:outputScript library="foundation-5/js/foundation" name="foundation.alert.js" />
        <h:outputScript library="foundation-5/js/foundation" name="foundation.topbar.js" />
        <h:outputScript library="foundation-5/js/foundation" name="foundation.orbit.js" />
        
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css" />
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        
        <h:outputStylesheet library="css" name="app.css" />
        <h:outputStylesheet library="css" name="toastr.css" />
        <h:outputStylesheet library="css" name="sweetalert.css" />
        <h:outputScript library="js" name="toastr.js" />
        <h:outputScript library="js" name="sweetalert.min.js" />
        
        <!--Import Google Icon Font-->
        <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
        <!--<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.10/jquery-ui.min.js"></script>-->
        
        <!--<h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />-->
        <!--<h:outputScript library="primefaces" name="jquery/jquery-plugins.js" target="head" />-->
        
<!--        <f:metadata>
            <f:event type="preRenderView" listener="# { home.updateView()}" />
        </f:metadata>-->
    </h:head>
    <h:body>
        
        <h:form id="commands">
            <pe:remoteCommand name="setPid" actionListener="#{index.setPid}">
                <pe:methodSignature parameters="java.lang.String" />
                <pe:methodParam name="pid" />
            </pe:remoteCommand>
            
            <pe:remoteCommand name="deleteProject" actionListener="#{home.deleteProject}">
                <pe:methodSignature parameters="java.lang.String" />
                <pe:methodParam name="pid" />
            </pe:remoteCommand>
            
            <pe:remoteCommand name="deleteEntry" actionListener="#{home.removeEntry}">
                <pe:methodSignature parameters="java.lang.String,java.lang.String,java.lang.String" />
                <pe:methodParam name="pid" />
                <pe:methodParam name="eid" />
                <pe:methodParam name="name" />
            </pe:remoteCommand>
            
            <pe:remoteCommand name="setParams" actionListener="#{viewEntry.setParams}">
                <pe:methodSignature parameters="java.lang.String,java.lang.String" />
                <pe:methodParam name="pid" />
                <pe:methodParam name="eid" />
            </pe:remoteCommand>
            
        </h:form>
        
        <nav class="top-bar" style="background-color: #1976d2;" data-topbar="true" role="navigation">
            <ul class="title-area">
              <li class="name">
                <h1><a href="#">Docky</a></h1>
              </li>
               <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
              <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
            </ul>

            <!--<section class="top-bar-section">-->
              <!-- Right Nav Section -->
              <!--<ul class="right">-->
                  <!--<li><a href="#" onclick="newEntry()">New</a></li>-->
          <!--      <li class="has-dropdown">
                  <a href="#">Right Button Dropdown</a>
                  <ul class="dropdown">
                    <li><a href="#">First link in dropdown</a></li>
                    <li class="active"><a href="#">Active link in dropdown</a></li>
                  </ul>
                </li>-->
              <!--</ul>-->
            <!--</section>-->
          </nav>
        
        <ul class="tabs" data-tab="true">
            <li class="tab-title active"><a id="projects_link" href="#panel1">Projects</a></li>
            <li class="tab-title"><a href="#panel2">New Project</a></li>
<!--            <li class="tab-title"><a href="#panel3">Tab 3</a></li>
            <li class="tab-title"><a href="#panel4">Tab 4</a></li>-->
          </ul>
          <div class="tabs-content">
            <div class="content active" id="panel1">
                <div class="panel">
                    <h:form id="projects-form">
                        <ui:repeat value="#{home.projects}" var="project">
                            <h3>#{project.name}
                                <small style="margin-left: 10px;">
                                    <p:commandLink value="New entry" actionListener="#{index.view(project)}" /> |
                                    <a href="#" onclick="remove('#{project.id}','#{project.name}')">Remove project</a>
                                </small>
                            </h3>
                            <p:dataTable 
                                value="#{home.sort(project.entries)}" 
                                var="entry"
                                emptyMessage="No entries found"
                                paginatorAlwaysVisible="false"
                                paginator="true"
                                paginatorPosition="bottom"
                                rows="10"
                                >
                                <p:column headerText="Created" width="200">
                                    #{home.formatDate(entry.date)}
                                </p:column>
                                <p:column headerText="Entries">
<!--                                    <a onclick="setParams('#{entry.id.idProject}','#{entry.id.id}')" href="#{request.contextPath}/faces/pages/view_entry.xhtml?pid=#{entry.id.idProject}&amp;id=#{entry.id.id}" >#{entry.title}</a>-->
                                    <p:commandLink value="#{entry.title}" actionListener="#{home.loadEntry(entry.id.idProject,entry.id.id)}" />
                                </p:column>
                                <p:column headerText="Action" width="200"> 
                                    <a href="#" onclick="removeEntry('#{project.id}','#{entry.id.id}','#{entry.title}')">Remove</a>
                                </p:column>
                            </p:dataTable>
                        </ui:repeat>
                    </h:form>
                </div>
            </div>
            <div class="content" id="panel2">
              <div class="panel">
                <h:form id="new_project_form">
                    <div class="row">
                          <div class="columns small-12">
                              <p>Tell me about your project</p>
                          </div> 
                          <div class="columns small-12">
                              <p:inputText placeholder="Name" value="#{home.newProject.name}" />
                          </div>
                          <div class="columns small-12">
                              <p:inputTextarea value="#{home.newProject.description}" placeholder="Description of project" rows="5" />
                          </div>
                          <div class="columns small-12">
                              <p:commandLink actionListener="#{home.addProject()}" style="margin-top: 10px;" styleClass="button" value="Create" />
                          </div>
                    </div>
                </h:form>
            </div>
            </div>
<!--            <div class="content" id="panel3">
              <p>This is the third panel of the basic tab example. This is the third panel of the basic tab example.</p>
            </div>
            <div class="content" id="panel4">
              <p>This is the fourth panel of the basic tab example. This is the fourth panel of the basic tab example.</p>
            </div>-->
          </div>
        
        <div class="footerholder">
            <div class="footer">
            Gonzalo H. Mendoza. Div-ID Software
            Â© 2016 All rights reserved
            </div>
        </div>
        <script>
            $(document).on("ready",function(){
               $(document).foundation(); 
               $("pre").each(function (i, e) {
                    hljs.highlightBlock(e);
                });
                $(".ui-column-filter.ui-inputfield.ui-inputtext").attr("placeholder","Entries");
//                $(".ui-column-filter.ui-inputfield.ui-inputtext").on("keyup",function(){
//                    tableEntries.filter();
//                });
            });
            function remove(pid, name){
                swal({
                    title: "Are you sure to remove " + name + " project?",
                    text: "You will not be able to recover this project",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Yes, remove it!",
                    cancelButtonText: "No, cancel!",
                    closeOnConfirm: true,
                    closeOnCancel: true
                  },
                  function(isConfirm){
                    if (isConfirm) {
                        deleteProject(pid);
//                      swal("Deleted!", "Your imaginary file has been deleted.", "success");
                    } 
//                    else {
//                      swal("Cancelled", "Your project is safe :)", "error");
//                    }
                  });
            }
            function removeEntry(pid, eid, name){
                swal({
                    title: "Are you sure to remove " + name + "?",
                    text: "You will not be able to recover this entry",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Yes, remove it!",
                    cancelButtonText: "No, cancel!",
                    closeOnConfirm: true,
                    closeOnCancel: true
                  },
                  function(isConfirm){
                    if (isConfirm) {
                        deleteEntry(pid, eid, name);
//                      swal("Deleted!", "Your imaginary file has been deleted.", "success");
                    } 
//                    else {
//                      swal("Cancelled", "Your project is safe :)", "error");
//                    }
                  });
            }
        </script>
    </h:body>
</html>
